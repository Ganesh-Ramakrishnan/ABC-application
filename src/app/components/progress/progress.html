<div class="progress-page" [class.light-theme]="!isDarkTheme">

  <!-- Theme Toggle -->
  <button class="theme-toggle" (click)="toggleTheme()">
    @if (isDarkTheme) {
      <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
      </svg>
    } @else {
      <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
              d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
      </svg>
    }
  </button>

  <div class="progress-content">

    <!-- Header -->
    <div class="progress-header">
      <button class="back-btn" (click)="goBack()">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
        </svg>
      </button>
      <div class="header-text">
        <span class="page-badge">DASHBOARD</span>
        <h1 class="page-title">Your <span class="highlight">Progress</span></h1>
      </div>
    </div>

    <!-- Stats Row -->
    <div class="stats-row">
      <!-- Completion -->
      <div class="stat-card">
        <div class="stat-icon stat-icon-purple">
          <svg width="22" height="22" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" />
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-label">Completion</span>
          <span class="stat-value">{{ completionPercentage }}%</span>
        </div>
        <div class="stat-bar-track">
          <div class="stat-bar-fill stat-bar-purple" [style.width.%]="completionPercentage"></div>
        </div>
      </div>

      <!-- Stars -->
      <div class="stat-card">
        <div class="stat-icon stat-icon-amber">
          <svg width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
            <path d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" />
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-label">Total Stars</span>
          <span class="stat-value">{{ totalStars }}</span>
        </div>
      </div>

      <!-- Streak -->
      <div class="stat-card">
        <div class="stat-icon stat-icon-orange">
          <svg width="22" height="22" fill="currentColor" viewBox="0 0 24 24">
            <path fill-rule="evenodd" d="M12.963 2.286a.75.75 0 00-1.071-.136 9.742 9.742 0 00-3.539 6.177A7.547 7.547 0 016.648 6.61a.75.75 0 00-1.152.082A9 9 0 1015.68 4.534a7.46 7.46 0 01-2.717-2.248zM15.75 14.25a3.75 3.75 0 11-7.313-1.172c.628.465 1.35.81 2.133 1a5.99 5.99 0 011.925-3.545 3.75 3.75 0 013.255 3.717z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-label">Day Streak</span>
          <span class="stat-value">{{ currentStreak }}</span>
        </div>
        <span class="stat-sub">
          @if (currentStreak === 0) { Start today! }
          @else if (currentStreak === 1) { Great start! }
          @else { Amazing streak! }
        </span>
      </div>
    </div>

    <!-- Badges Section -->
    <div class="section-card">
      <div class="section-header">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24" class="section-icon">
          <path fill-rule="evenodd" d="M5.166 2.621v.858c-1.035.148-2.059.33-3.071.543a.75.75 0 00-.584.859 6.753 6.753 0 006.138 5.6 6.73 6.73 0 002.743 1.346A6.707 6.707 0 019.279 15H8.54c-1.036 0-1.875.84-1.875 1.875V19.5h-.75a.75.75 0 000 1.5h12.75a.75.75 0 000-1.5h-.75v-2.625c0-1.036-.84-1.875-1.875-1.875h-.739a6.707 6.707 0 01-1.112-3.173 6.73 6.73 0 002.743-1.347 6.753 6.753 0 006.139-5.6.75.75 0 00-.585-.858 47.077 47.077 0 00-3.07-.543V2.62a.75.75 0 00-.658-.744 49.22 49.22 0 00-6.093-.377c-2.063 0-4.096.128-6.093.377a.75.75 0 00-.657.744z" clip-rule="evenodd" />
        </svg>
        <h2 class="section-title">Trophy Case</h2>
      </div>

      <div class="badges-grid">
        @for (badge of badges; track badge.name) {
          <div class="badge-card" [class.badge-unlocked]="badge.unlocked" [class.badge-locked]="!badge.unlocked">
            <div class="badge-icon-wrap">
              <span class="badge-icon-text">{{ badge.icon }}</span>
            </div>
            <h3 class="badge-name">{{ badge.name }}</h3>
            <p class="badge-desc">{{ badge.description }}</p>
            @if (badge.unlocked) {
              <div class="badge-check">
                <svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="3">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                </svg>
              </div>
            }
            @if (!badge.unlocked) {
              <div class="badge-lock-overlay">
                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24" class="lock-icon">
                  <path fill-rule="evenodd" d="M12 1.5a5.25 5.25 0 00-5.25 5.25v3a3 3 0 00-3 3v6.75a3 3 0 003 3h10.5a3 3 0 003-3v-6.75a3 3 0 00-3-3v-3c0-2.9-2.35-5.25-5.25-5.25zm3.75 8.25v-3a3.75 3.75 0 10-7.5 0v3h7.5z" clip-rule="evenodd" />
                </svg>
              </div>
            }
          </div>
        }
      </div>

      @if (badges.length === 0) {
        <div class="empty-badges">
          <p>Complete activities to earn badges!</p>
        </div>
      }
    </div>

    <!-- Achievements Section -->
    <div class="section-card">
      <div class="section-header">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24" class="section-icon">
          <path fill-rule="evenodd" d="M9 4.5a.75.75 0 01.721.544l.813 2.846a3.75 3.75 0 002.576 2.576l2.846.813a.75.75 0 010 1.442l-2.846.813a3.75 3.75 0 00-2.576 2.576l-.813 2.846a.75.75 0 01-1.442 0l-.813-2.846a3.75 3.75 0 00-2.576-2.576l-2.846-.813a.75.75 0 010-1.442l2.846-.813A3.75 3.75 0 007.466 7.89l.813-2.846A.75.75 0 019 4.5z" clip-rule="evenodd" />
        </svg>
        <h2 class="section-title">Achievements</h2>
      </div>

      <div class="achievements-list">
        <div class="achievement-row">
          <div class="achievement-left">
            <div class="achievement-icon achievement-icon-purple">
              <svg width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M5.166 2.621v.858c-1.035.148-2.059.33-3.071.543a.75.75 0 00-.584.859 6.753 6.753 0 006.138 5.6 6.73 6.73 0 002.743 1.346A6.707 6.707 0 019.279 15H8.54c-1.036 0-1.875.84-1.875 1.875V19.5h-.75a.75.75 0 000 1.5h12.75a.75.75 0 000-1.5h-.75v-2.625c0-1.036-.84-1.875-1.875-1.875h-.739a6.707 6.707 0 01-1.112-3.173 6.73 6.73 0 002.743-1.347 6.753 6.753 0 006.139-5.6.75.75 0 00-.585-.858 47.077 47.077 0 00-3.07-.543V2.62a.75.75 0 00-.658-.744 49.22 49.22 0 00-6.093-.377c-2.063 0-4.096.128-6.093.377a.75.75 0 00-.657.744z" clip-rule="evenodd" />
              </svg>
            </div>
            <div>
              <h4 class="achievement-name">Badges Earned</h4>
              <p class="achievement-sub">{{ unlockedBadges.length }} / {{ badges.length }}</p>
            </div>
          </div>
          <span class="achievement-value achievement-value-purple">{{ unlockedBadges.length }}</span>
        </div>

        <div class="achievement-row">
          <div class="achievement-left">
            <div class="achievement-icon achievement-icon-blue">
              <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931z" />
              </svg>
            </div>
            <div>
              <h4 class="achievement-name">Letters Mastered</h4>
              <p class="achievement-sub">Keep practicing!</p>
            </div>
          </div>
          <span class="achievement-value achievement-value-blue">{{ completionPercentage }}%</span>
        </div>
      </div>
    </div>

    <!-- Action Button -->
    <div class="action-row">
      <button class="continue-btn" (click)="goToLetters()">
        Continue Learning
        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
        </svg>
      </button>
    </div>

  </div>
</div>
