<div class="tracing-page">

  <div class="tracing-container">

    <!-- ── Top Bar ── -->
    <div class="top-bar">
      <!-- Back -->
      <button (click)="goBack()" class="back-btn">
        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5"/>
        </svg>
      </button>

      <!-- Letter Selector Pills (center) -->
      <div class="letter-selector-scroll">
        <div class="letter-selector-track">
          @for (letter of letterGroup; track letter) {
            <button
              class="letter-card"
              [class.letter-card-active]="letter === currentLetter"
              (click)="goToLetter(letter)">
              {{letter}}
            </button>
          }
        </div>
      </div>

    </div>

    <!-- Celebration Overlay -->
    @if (showCelebration) {
      <div class="celebration-overlay">
        <div class="celebration-text">Well done!</div>
      </div>
    }

    <!-- ── Main Layout: canvas left + info right on desktop ── -->
    <div class="main-layout">

    <!-- SVG Tracing Canvas -->
    <div class="canvas-wrapper">
      <div class="relative w-full" style="aspect-ratio: 1/1; max-width: 500px; margin: 0 auto;">

        <!-- WRITING MODE: Block letter reference + free drawing canvas -->
        <div *ngIf="isFreeWriting" class="relative w-full h-full" style="aspect-ratio: 1/1;">
          <!-- Block/Filled letter reference (faint background like the image) -->
          <svg
            viewBox="0 0 400 400"
            class="absolute top-0 left-0 w-full h-full"
            style="pointer-events: none; z-index: 1;">

            <!-- Solid filled letter with gray fill and darker gray outline -->
            <text
              x="200"
              y="310"
              font-size="340"
              font-family="Arial Black, Arial, sans-serif"
              font-weight="900"
              text-anchor="middle"
              fill="#E5E7EB"
              stroke="#9CA3AF"
              stroke-width="3">
              {{currentLetter}}
            </text>

            <!-- Letter decoration placeholder -->
            <text x="320" y="90" font-size="50" id="letterDecorWriting" opacity="0"></text>
          </svg>

          <!-- Drawing canvas for free writing (on top of letter) -->
          <canvas
            #drawingCanvas
            class="absolute top-0 left-0 w-full h-full"
            style="touch-action: none; pointer-events: auto; z-index: 2; background: transparent;">
          </canvas>
        </div>

        <!-- TRACING MODE: Mask reveal system -->
        <svg
          *ngIf="!isFreeWriting"
          #tracingSvg
          viewBox="0 0 400 400"
          class="w-full h-full"
          style="touch-action: none; user-select: none; overflow: hidden;">

          <!-- Definitions -->
          <defs>
            <!-- Clipping path to ensure everything stays within canvas -->
            <clipPath id="canvasClip">
              <rect x="0" y="0" width="400" height="400"/>
            </clipPath>

            <clipPath id="letterAClip">
              <rect x="0" y="0" width="400" height="400"/>
            </clipPath>

            <!-- Clipping path for letter B - matches tracing strokes -->
            <!-- Vertical: y=55-345, Top bump: y=55-200, Bottom bump: y=200-345 (equal 50/50 split) -->
            <!-- Using Q curves for smooth rounded bumps like a proper B -->
            <clipPath id="letterBClip">
              <!-- Vertical stem: x=110 ±14 = 96-124, y=55-345 ±14 = 41-359 -->
              <path d="M 96 41 L 124 41 L 124 359 L 96 359 Z"/>
              <!-- Top bump with proper rounded curve -->
              <path d="M 110 41 L 200 41 Q 294 41 294 127.5 Q 294 214 200 214 L 110 214 L 110 186 L 200 186 Q 266 186 266 127.5 Q 266 69 200 69 L 110 69 Z"/>
              <!-- Bottom bump with proper rounded curve -->
              <path d="M 110 186 L 200 186 Q 294 186 294 272.5 Q 294 359 200 359 L 110 359 L 110 331 L 200 331 Q 266 331 266 272.5 Q 266 214 200 214 L 110 214 Z"/>
            </clipPath>

            <!-- Clipping path for letter C - proper C shape -->
            <!-- Tracing: starts at (280,100), curves through (200,55) at top, (80,200) at left, (200,345) at bottom, ends at (280,300) -->
            <clipPath id="letterCClip">
              <!-- C shape: outer arc then inner arc back, stroke width 28 (±14px) -->
              <path d="M 294 100 Q 294 41 200 41 Q 66 41 66 200 Q 66 359 200 359 Q 294 359 294 300 L 266 300 Q 266 331 200 331 Q 94 331 94 200 Q 94 69 200 69 Q 266 69 266 100 Z"/>
            </clipPath>

            <!-- Clipping path for letter D - vertical stem + curved bump -->
            <!-- Tracing: Vertical y=55-345 at x=100, Bump curves to x=300 -->
            <clipPath id="letterDClip">
              <!-- Vertical stem: x=100 ±14 = 86-114 -->
              <path d="M 86 41 L 114 41 L 114 359 L 86 359 Z"/>
              <!-- D bump: outer at x=314, inner at x=286, joined to stem -->
              <path d="M 86 41 L 200 41 Q 314 41 314 200 Q 314 359 200 359 L 86 359 L 86 331 L 200 331 Q 286 331 286 200 Q 286 69 200 69 L 86 69 Z"/>
            </clipPath>

            <!-- Clipping path for letter E -->
            <clipPath id="letterEClip">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z"/>
              <path d="M 100 66 L 294 66 L 294 94 L 100 94 Z"/>
              <path d="M 100 186 L 274 186 L 274 214 L 100 214 Z"/>
              <path d="M 100 306 L 294 306 L 294 334 L 100 334 Z"/>
            </clipPath>

            <!-- Clipping path for letter F -->
            <clipPath id="letterFClip">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z"/>
              <path d="M 100 66 L 294 66 L 294 94 L 100 94 Z"/>
              <path d="M 100 186 L 274 186 L 274 214 L 100 214 Z"/>
            </clipPath>

            <!-- Clipping path for letter G -->
            <clipPath id="letterGClip">
              <!-- G shape: C-arc with top opening at y=86-114, right arm from tongue down to bottom curve -->
              <!-- Outer: starts top-right (294,100), arcs left-down-right to (314,260), down to tongue (314,186), left to (186,186) -->
              <!-- Inner: tongue bottom (186,214), right to (286,214), up to (286,260), inner arc back to top (266,100) -->
              <path d="M 294 100 Q 294 66 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 246 L 314 186 L 186 186 L 186 214 L 286 214 L 286 246 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Q 266 94 266 100 Z"/>
            </clipPath>

            <!-- Clipping path for letter H -->
            <clipPath id="letterHClip">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z"/>
              <path d="M 286 66 L 314 66 L 314 334 L 286 334 Z"/>
              <path d="M 86 186 L 314 186 L 314 214 L 86 214 Z"/>
            </clipPath>

            <!-- Clipping path for letter I -->
            <clipPath id="letterIClip">
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z"/>
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z"/>
              <path d="M 106 306 L 294 306 L 294 334 L 106 334 Z"/>
            </clipPath>

            <!-- Clipping path for letter J - centered stem at x=200 -->
            <clipPath id="letterJClip">
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z"/>
              <path d="M 186 66 L 214 66 L 214 280 Q 214 334 160 334 Q 106 334 106 280 L 134 280 Q 134 306 160 306 Q 186 306 186 280 Z"/>
            </clipPath>

            <!-- Clipping path for letter K -->
            <clipPath id="letterKClip">
              <!-- Vertical stem: x=100 center ±14 -->
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z"/>
              <!-- Upper diagonal: (300,80)->(100,200), perp offset ±(7,12), correct winding -->
              <path d="M 293 68 L 307 92 L 107 212 L 93 188 Z"/>
              <!-- Lower diagonal: (100,200)->(300,320), perp offset ±(7,12), correct winding -->
              <path d="M 107 188 L 93 212 L 293 332 L 307 308 Z"/>
            </clipPath>

            <!-- Clipping path for letter L -->
            <clipPath id="letterLClip">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z"/>
              <path d="M 86 306 L 294 306 L 294 334 L 86 334 Z"/>
            </clipPath>

            <!-- Clipping path for letter M -->
            <clipPath id="letterMClip">
              <!-- M shape: stems 28px, diagonals with 36px gap (same as V letter) -->
              <path d="M 66 66 L 66 334 L 94 334 L 94 102 L 200 214 L 306 102 L 306 334 L 334 334 L 334 66 L 306 66 L 200 178 L 94 66 Z"/>
            </clipPath>

            <!-- Clipping path for letter N -->
            <clipPath id="letterNClip">
              <!-- Unified N: stems 28px, diagonal 28px perpendicular width -->
              <!-- Center diagonal: (100,66)->(300,334), direction (200,268), |n|=334.4 -->
              <!-- 14px offset each side: outer at (118,66)-(286,292), inner at (114,108)-(283,334) -->
              <path d="M 86 334 L 86 66 L 118 66 L 286 292 L 286 66 L 314 66 L 314 334 L 283 334 L 114 108 L 114 334 Z"/>
            </clipPath>

            <!-- Clipping path for letter O -->
            <clipPath id="letterOClip">
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z"/>
            </clipPath>

            <!-- Clipping path for letter P -->
            <clipPath id="letterPClip">
              <!-- Unified P: stem 28px (86-114), narrow bowl (66-190), 28px stroke -->
              <path d="M 86 334 L 86 66 L 210 66 Q 260 66 260 128 Q 260 190 210 190 L 114 190 L 114 334 Z M 114 94 L 210 94 Q 232 94 232 128 Q 232 162 210 162 L 114 162 Z" fill-rule="evenodd"/>
            </clipPath>

            <!-- Clipping paths for letter Q -->
            <clipPath id="letterQClipOval">
              <!-- Oval ring only -->
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z" fill-rule="evenodd"/>
            </clipPath>
            <clipPath id="letterQClipTail">
              <!-- Tail only -->
              <path d="M 269 290 L 329 344 L 311 364 L 251 310 Z"/>
            </clipPath>
            <!-- Combined Q clip for tracing mask -->
            <clipPath id="letterQClip">
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z" fill-rule="evenodd"/>
              <path d="M 269 290 L 329 344 L 311 364 L 251 310 Z"/>
            </clipPath>

            <!-- Clipping paths for letter R -->
            <clipPath id="letterRClipBody">
              <!-- R stem: 28px wide, full height -->
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z"/>
              <!-- R bowl: smooth round bump using cubic bezier, y=66 to y=200 -->
              <path d="M 86 66 L 190 66 C 290 66 290 200 190 200 L 86 200 L 86 172 L 190 172 C 262 172 262 94 190 94 L 86 94 Z"/>
            </clipPath>
            <clipPath id="letterRClipLeg">
              <!-- R leg: center (190,186)→(280,334), extended into bowl to eliminate gap -->
              <path d="M 202 178 L 292 326 L 268 342 L 178 194 Z"/>
            </clipPath>

            <!-- Clipping path for letter S -->
            <clipPath id="letterSClip">
              <!-- Top half of S: C-curve opening right -->
              <path d="
                M 270 110 Q 270 66 200 66 Q 110 66 110 138
                Q 110 214 200 214
                L 200 186
                Q 138 186 138 138
                Q 138 94 200 94 Q 242 94 242 110
                Z
              "/>
              <!-- Bottom half of S: C-curve opening left -->
              <path d="
                M 130 290 Q 130 334 200 334 Q 290 334 290 262
                Q 290 186 200 186
                L 200 214
                Q 262 214 262 262
                Q 262 306 200 306 Q 158 306 158 290
                Z
              "/>
            </clipPath>

            <!-- Clipping path for letter T -->
            <clipPath id="letterTClip">
              <path d="M 86 66 L 314 66 L 314 94 L 86 94 Z"/>
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z"/>
            </clipPath>

            <!-- Clipping path for letter U -->
            <clipPath id="letterUClip">
              <path d="M 86 66 L 114 66 L 114 280 Q 114 326 200 326 Q 286 326 286 280 L 286 66 L 314 66 L 314 280 Q 314 354 200 354 Q 86 354 86 280 Z"/>
            </clipPath>

            <!-- Clipping path for letter V -->
            <!-- Tracing center: (80,80)→(200,320)→(320,80), 28px perpendicular stroke width -->
            <clipPath id="letterVClip">
              <path d="M 68 86 L 188 326 L 212 326 L 332 86 L 308 74 L 200 290 L 92 74 Z"/>
            </clipPath>

            <!-- Clipping path for letter W -->
            <clipPath id="letterWClip">
              <path d="M 66 82 L 106 322 L 134 318 L 94 78 Z"/>
              <path d="M 133 326 L 213 166 L 187 154 L 107 314 Z"/>
              <path d="M 187 166 L 267 326 L 293 314 L 213 154 Z"/>
              <path d="M 294 322 L 334 82 L 306 78 L 266 318 Z"/>
              <path d="M 106 322 L 134 318 L 133 326 Z"/>
              <path d="M 107 314 L 106 322 L 133 326 Z"/>
              <path d="M 213 166 L 187 154 L 187 166 Z"/>
              <path d="M 213 166 L 213 154 L 187 154 Z"/>
              <path d="M 267 326 L 293 314 L 294 322 Z"/>
              <path d="M 266 318 L 267 326 L 293 314 Z"/>
            </clipPath>

            <!-- Clipping path for letter X -->
            <clipPath id="letterXClip">
              <path d="M 89 89 L 289 329 L 311 311 L 111 71 Z"/>
              <path d="M 289 71 L 89 311 L 111 329 L 311 89 Z"/>
            </clipPath>

            <!-- Clipping path for letter Y -->
            <clipPath id="letterYClip">
              <path d="M 89 89 L 189 209 L 211 191 L 111 71 Z"/>
              <path d="M 289 71 L 189 191 L 211 209 L 311 89 Z"/>
              <path d="M 186 200 L 186 320 L 214 320 L 214 200 Z"/>
              <path d="M 186 200 L 189 209 L 211 209 L 214 200 Z"/>
              <path d="M 189 191 L 186 200 L 214 200 L 211 191 Z"/>
            </clipPath>

            <!-- Clipping path for letter Z -->
            <clipPath id="letterZClip">
              <path d="M 100 66 L 300 66 L 300 94 L 100 94 Z"/>
              <path d="M 289 71 L 89 311 L 111 329 L 311 89 Z"/>
              <path d="M 100 306 L 300 306 L 300 334 L 100 334 Z"/>
              <path d="M 300 66 L 311 89 L 300 94 Z"/>
              <path d="M 289 71 L 300 66 L 300 94 Z"/>
              <path d="M 89 311 L 100 306 L 100 334 Z"/>
              <path d="M 100 306 L 111 329 L 100 334 Z"/>
            </clipPath>

            <!-- Clipping paths for numbers 0-9 -->
            <clipPath id="letter0Clip">
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z" clip-rule="evenodd"/>
            </clipPath>

            <clipPath id="letter1Clip">
              <!-- Vertical stem -->
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z"/>
              <!-- Flag diagonal with proper 28px perpendicular width -->
              <path d="M 152 94 L 192 68 L 208 92 L 168 118 Z"/>
              <!-- Bottom bar -->
              <path d="M 126 306 L 274 306 L 274 334 L 126 334 Z"/>
            </clipPath>

            <clipPath id="letter2Clip">
              <!-- Top curve + diagonal -->
              <path d="M 86 120 Q 86 66 200 66 Q 314 66 314 120 Q 314 186 210 230 L 110 330 L 90 310 L 190 210 Q 286 166 286 120 Q 286 94 200 94 Q 114 94 114 120 Z"/>
              <!-- Bottom bar -->
              <path d="M 86 306 L 314 306 L 314 334 L 86 334 Z"/>
            </clipPath>

            <clipPath id="letter3Clip">
              <path d="M 86 100 Q 126 66 200 66 Q 314 66 314 130 Q 314 186 214 200 Q 314 214 314 270 Q 314 334 200 334 Q 126 334 86 300 L 106 272 Q 140 306 200 306 Q 286 306 286 270 Q 286 214 200 214 L 200 186 Q 286 186 286 130 Q 286 94 200 94 Q 140 94 106 128 Z"/>
            </clipPath>

            <clipPath id="letter4Clip">
              <!-- Vertical stem -->
              <path d="M 246 66 L 274 66 L 274 334 L 246 334 Z"/>
              <!-- Diagonal -->
              <path d="M 270 90 L 110 250 L 90 230 L 250 70 Z"/>
              <!-- Horizontal bar -->
              <path d="M 86 226 L 274 226 L 274 254 L 86 254 Z"/>
            </clipPath>

            <clipPath id="letter5Clip">
              <!-- Top horizontal bar -->
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z"/>
              <!-- Vertical stem -->
              <path d="M 106 66 L 134 66 L 134 184 L 106 184 Z"/>
              <!-- Belly curve (outer then inner reversed) -->
              <path d="M 110 160 Q 202 136 262 182 Q 304 229 261 299 Q 202 344 110 310 L 130 290 Q 198 316 239 281 Q 276 231 239 198 Q 198 164 130 180 Z"/>
            </clipPath>

            <clipPath id="letter6Clip">
              <path d="M 280 96 Q 240 66 180 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 260 Q 314 186 200 186 Q 114 186 114 230 L 114 186 Q 114 94 180 94 Q 220 94 252 124 Z M 200 214 Q 286 214 286 260 Q 286 306 200 306 Q 114 306 114 260 Q 114 214 200 214 Z" clip-rule="evenodd"/>
            </clipPath>

            <clipPath id="letter7Clip">
              <path d="M 86 66 L 323 66 L 189 334 L 160 334 L 277 94 L 86 94 Z"/>
            </clipPath>

            <clipPath id="letter8Clip">
              <path d="M 200 200 Q 86 200 86 130 Q 86 66 200 66 Q 314 66 314 130 Q 314 200 200 200 M 200 172 Q 286 172 286 130 Q 286 94 200 94 Q 114 94 114 130 Q 114 172 200 172 Z" clip-rule="evenodd"/>
              <path d="M 200 200 Q 86 200 86 270 Q 86 334 200 334 Q 314 334 314 270 Q 314 200 200 200 M 200 228 Q 286 228 286 270 Q 286 306 200 306 Q 114 306 114 270 Q 114 228 200 228 Z" clip-rule="evenodd"/>
            </clipPath>

            <clipPath id="letter9Clip">
              <path d="M 120 304 Q 140 334 220 334 Q 314 334 314 200 Q 314 66 200 66 Q 86 66 86 130 Q 86 200 200 200 Q 286 200 286 170 L 286 200 Q 286 306 220 306 Q 160 306 140 276 Z M 200 172 Q 114 172 114 130 Q 114 94 200 94 Q 286 94 286 130 Q 286 172 200 172 Z" clip-rule="evenodd"/>
            </clipPath>

            <!-- Clipping paths for lowercase letters a-z -->
            <clipPath id="letteraClip">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 L 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 160 Z"/>
              <path d="M 266 106 L 294 106 L 294 294 L 266 294 Z"/>
            </clipPath>

            <clipPath id="letterbClip">
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z"/>
              <path d="M 120 146 Q 120 106 200 106 Q 294 106 294 200 Q 294 294 200 294 Q 106 294 106 226 L 134 226 Q 134 266 200 266 Q 266 266 266 200 Q 266 134 200 134 Q 134 134 134 174 Z"/>
            </clipPath>

            <clipPath id="lettercClip">
              <path d="M 294 146 Q 274 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 274 294 294 254 L 266 240 Q 254 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 246 134 266 160 Z"/>
            </clipPath>

            <clipPath id="letterdClip">
              <path d="M 266 46 L 294 46 L 294 294 L 266 294 Z"/>
              <path d="M 294 226 Q 294 294 200 294 Q 106 294 106 200 Q 106 106 200 106 Q 294 106 294 146 L 266 160 Q 266 134 200 134 Q 134 134 134 200 Q 134 266 200 266 Q 266 266 266 240 Z"/>
            </clipPath>

            <clipPath id="lettereClip">
              <!-- Top dome: same as 'c' top half but closed at bar level -->
              <path d="M 294 186 Q 294 106 200 106 Q 106 106 106 186 L 134 186 Q 134 134 200 134 Q 266 134 266 186 Z"/>
              <!-- Bottom C-shape: same as 'c' bottom half, open at right -->
              <path d="M 294 254 Q 274 294 200 294 Q 106 294 106 214 L 134 214 Q 134 266 200 266 Q 254 266 266 240 Z"/>
              <!-- Horizontal bar connecting dome to bottom -->
              <path d="M 106 186 L 294 186 L 294 214 L 106 214 Z"/>
            </clipPath>

            <clipPath id="letterfClip">
              <!-- Hook + stem -->
              <path d="M 274 100 Q 274 46 200 46 Q 146 46 146 100 L 146 294 L 174 294 L 174 100 Q 174 74 200 74 Q 246 74 246 100 Z"/>
              <!-- Crossbar -->
              <path d="M 106 146 L 234 146 L 234 174 L 106 174 Z"/>
            </clipPath>

            <clipPath id="lettergClip">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 L 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 160 Z"/>
              <path d="M 266 106 L 294 106 L 294 354 Q 294 394 200 394 Q 126 394 106 354 L 134 340 Q 146 366 200 366 Q 266 366 266 340 Z"/>
            </clipPath>

            <clipPath id="letterhClip">
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z"/>
              <path d="M 120 166 Q 120 106 200 106 Q 294 106 294 166 L 294 294 L 266 294 L 266 166 Q 266 134 200 134 Q 134 134 134 194 Z"/>
            </clipPath>

            <clipPath id="letteriClip">
              <path d="M 186 106 L 214 106 L 214 294 L 186 294 Z"/>
            </clipPath>

            <clipPath id="letterjClip">
              <path d="M 206 106 L 234 106 L 234 354 Q 234 394 160 394 Q 106 394 106 354 L 134 340 Q 134 366 160 366 Q 206 366 206 340 Z"/>
            </clipPath>

            <clipPath id="letterkClip">
              <!-- Vertical stem -->
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z"/>
              <!-- Upper diagonal arm: (260,120)->(120,200) with 14px perp offset -->
              <path d="M 253 108 L 267 132 L 134 208 L 134 176 Z"/>
              <!-- Lower diagonal arm: (120,200)->(280,280) with 14px perp offset -->
              <path d="M 134 191 L 286 267 L 274 293 L 134 223 Z"/>
            </clipPath>

            <clipPath id="letterlClip">
              <path d="M 186 46 L 214 46 L 214 294 L 186 294 Z"/>
            </clipPath>

            <clipPath id="lettermClip">
              <!-- Left n-shape: left stem + first arch + middle stem -->
              <path d="M 66 294 L 66 160 Q 66 106 140 106 Q 214 106 214 160 L 214 294 L 186 294 L 186 160 Q 186 134 140 134 Q 94 134 94 160 L 94 294 Z"/>
              <!-- Right n-shape: middle stem + second arch + right stem -->
              <path d="M 186 294 L 186 160 Q 186 106 260 106 Q 334 106 334 160 L 334 294 L 306 294 L 306 160 Q 306 134 260 134 Q 214 134 214 160 L 214 294 Z"/>
            </clipPath>

            <clipPath id="letternClip">
              <path d="M 106 294 L 134 294 L 134 146 L 106 146 Z"/>
              <path d="M 120 166 Q 120 106 200 106 Q 294 106 294 166 L 294 294 L 266 294 L 266 166 Q 266 134 200 134 Q 134 134 134 194 Z"/>
            </clipPath>

            <clipPath id="letteroClip">
              <path d="M 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 Q 294 106 200 106 M 200 134 Q 266 134 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Z"/>
            </clipPath>

            <clipPath id="letterpClip">
              <path d="M 106 106 L 134 106 L 134 374 L 106 374 Z"/>
              <path d="M 120 146 Q 120 106 200 106 Q 294 106 294 200 Q 294 294 200 294 Q 106 294 106 226 L 134 226 Q 134 266 200 266 Q 266 266 266 200 Q 266 134 200 134 Q 134 134 134 174 Z"/>
            </clipPath>

            <clipPath id="letterqClip">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 226 L 266 226 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 174 Z"/>
              <path d="M 266 106 L 294 106 L 294 374 L 266 374 Z"/>
            </clipPath>

            <clipPath id="letterrClip">
              <path d="M 126 106 L 126 294 L 154 294 L 154 106 Z"/>
              <path d="M 126 160 Q 126 106 200 106 Q 254 106 254 150 A 14 14 0 0 1 226 150 Q 226 134 200 134 Q 154 134 154 160 Z"/>
            </clipPath>

            <clipPath id="lettersClip">
              <!-- Top half of s: C-curve opening right -->
              <path d="M 274 150 Q 274 106 200 106 Q 126 106 126 160 Q 126 214 200 214 L 200 186 Q 154 186 154 160 Q 154 134 200 134 Q 246 134 246 150 Z"/>
              <!-- Bottom half of s: C-curve opening left -->
              <path d="M 126 250 Q 126 294 200 294 Q 274 294 274 240 Q 274 186 200 186 L 200 214 Q 246 214 246 240 Q 246 266 200 266 Q 154 266 154 250 Z"/>
            </clipPath>

            <clipPath id="lettertClip">
              <path d="M 186 46 L 186 260 Q 186 294 230 294 A 14 14 0 0 0 230 266 Q 214 266 214 260 L 214 46 Z"/>
              <path d="M 116 106 L 274 106 L 274 134 L 116 134 Z"/>
            </clipPath>

            <clipPath id="letteruClip">
              <path d="M 106 106 L 106 220 Q 106 294 200 294 Q 294 294 294 220 L 294 106 L 266 106 L 266 220 Q 266 266 200 266 Q 134 266 134 220 L 134 106 Z"/>
              <path d="M 266 220 L 294 220 L 294 294 L 266 294 Z"/>
            </clipPath>

            <clipPath id="lettervClip">
              <path d="M 88 127 L 188 287 L 212 287 L 312 127 L 288 113 L 200 273 L 112 113 Z"/>
            </clipPath>

            <clipPath id="letterwClip">
              <!-- Stroke 1: (80,120)→(140,280) -->
              <path d="M 67 125 L 127 285 L 153 275 L 93 115 Z"/>
              <!-- Stroke 2: (140,280)→(200,180) -->
              <path d="M 152 287 L 212 187 L 188 173 L 128 273 Z"/>
              <!-- Stroke 3: (200,180)→(260,280) -->
              <path d="M 188 187 L 248 287 L 272 273 L 212 173 Z"/>
              <!-- Stroke 4: (260,280)→(320,120) -->
              <path d="M 273 285 L 333 125 L 307 115 L 247 275 Z"/>
              <!-- Junction fills -->
              <path d="M 127 285 L 152 287 L 153 275 L 128 273 Z"/>
              <path d="M 212 187 L 188 187 L 188 173 L 212 173 Z"/>
              <path d="M 248 287 L 273 285 L 272 273 L 247 275 Z"/>
            </clipPath>

            <clipPath id="letterxClip">
              <!-- Stroke 1: (120,120)→(280,280) -->
              <path d="M 110 130 L 270 290 L 290 270 L 130 110 Z"/>
              <!-- Stroke 2: (280,120)→(120,280) -->
              <path d="M 270 110 L 110 270 L 130 290 L 290 130 Z"/>
            </clipPath>

            <clipPath id="letteryClip">
              <!-- U-shape body -->
              <path d="M 126 106 L 126 220 Q 126 274 200 274 Q 274 274 274 220 L 274 106 L 246 106 L 246 220 Q 246 246 200 246 Q 154 246 154 220 L 154 106 Z"/>
              <!-- Right stem descender below curve -->
              <path d="M 274 220 L 274 354 Q 274 394 200 394 Q 126 394 106 354 L 134 340 Q 146 366 200 366 Q 246 366 246 340 L 246 220 Z"/>
            </clipPath>

            <clipPath id="letterzClip">
              <path d="M 106 106 L 294 106 L 294 134 L 154 266 L 294 266 L 294 294 L 106 294 L 106 266 L 246 134 L 106 134 Z"/>
            </clipPath>

            <!-- Mask for revealing the colored letter -->
            <mask id="traceMask">
              <rect width="400" height="400" fill="black"/>
              <!-- White areas will reveal the letter - precise width to match letter thickness -->
              <path id="maskPath" stroke="white" stroke-width="28" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
            </mask>

            <!-- Pattern for decorative stars/flowers -->
            <pattern id="decorPattern" x="0" y="0" width="50" height="50" patternUnits="userSpaceOnUse">
              <text x="10" y="20" font-size="20">⭐</text>
              <text x="30" y="40" font-size="15">✨</text>
            </pattern>

            <!-- Gradient for sliding cursor -->
            <radialGradient id="cursorGradient">
              <stop offset="0%" stop-color="#FEF3C7"/>
              <stop offset="100%" stop-color="#FCD34D"/>
            </radialGradient>
          </defs>

          <!-- All content clipped to canvas boundaries -->
          <g clip-path="url(#canvasClip)">

          <!-- Letter A using SVG paths (perfect control) -->
          <g *ngIf="currentLetter === 'A'" id="letterPaths">
            <g id="grayLetterPaths">
              <line x1="125" y1="280" x2="200" y2="60" stroke="#F9C5D5" stroke-width="30" stroke-linecap="round"/>
              <line x1="200" y1="60" x2="275" y2="280" stroke="#F9C5D5" stroke-width="30" stroke-linecap="round"/>
              <line x1="152" y1="190" x2="248" y2="190" stroke="#F9C5D5" stroke-width="30" stroke-linecap="round"/>
              <circle cx="125" cy="280" r="5" fill="#fff"/>
              <circle cx="150" cy="212" r="5" fill="#fff"/>
              <circle cx="168" cy="160" r="5" fill="#fff"/>
              <circle cx="185" cy="110" r="5" fill="#fff"/>
              <circle cx="218" cy="110" r="5" fill="#fff"/>
              <circle cx="235" cy="160" r="5" fill="#fff"/>
              <circle cx="252" cy="212" r="5" fill="#fff"/>
              <circle cx="275" cy="280" r="5" fill="#fff"/>
            </g>

            <g mask="url(#traceMask)">
              <line x1="125" y1="280" x2="200" y2="60" stroke="#F97316" stroke-width="30" stroke-linecap="round"/>
              <line x1="200" y1="60" x2="275" y2="280" stroke="#F97316" stroke-width="30" stroke-linecap="round"/>
              <line x1="152" y1="190" x2="248" y2="190" stroke="#F97316" stroke-width="30" stroke-linecap="round"/>
              <circle cx="125" cy="280" r="5" fill="#fff"/>
              <circle cx="150" cy="212" r="5" fill="#fff"/>
              <circle cx="168" cy="160" r="5" fill="#fff"/>
              <circle cx="185" cy="110" r="5" fill="#fff"/>
              <circle cx="218" cy="110" r="5" fill="#fff"/>
              <circle cx="235" cy="160" r="5" fill="#fff"/>
              <circle cx="252" cy="212" r="5" fill="#fff"/>
              <circle cx="275" cy="280" r="5" fill="#fff"/>
            </g>
          </g>

          <!-- Letter B using SVG paths (perfect control) -->
          <!-- Tracing: Vertical y=55-345, Top bump y=55-200, Bottom bump y=200-345 (equal 50/50 split) -->
          <!-- Using Q curves for smooth rounded B shape -->
          <g *ngIf="currentLetter === 'B'" id="letterBPaths">
            <!-- Gray outline paths (background) - matches tracing strokes -->
            <g id="grayLetterBPaths">
              <!-- Vertical stem: x=110 ±14 = 96-124 -->
              <path d="M 96 41 L 124 41 L 124 359 L 96 359 Z" fill="#E5E7EB"/>
              <!-- Top bump with proper rounded curve -->
              <path d="M 110 41 L 200 41 Q 294 41 294 127.5 Q 294 214 200 214 L 110 214 L 110 186 L 200 186 Q 266 186 266 127.5 Q 266 69 200 69 L 110 69 Z" fill="#E5E7EB"/>
              <!-- Bottom bump with proper rounded curve -->
              <path d="M 110 186 L 200 186 Q 294 186 294 272.5 Q 294 359 200 359 L 110 359 L 110 331 L 200 331 Q 266 331 266 272.5 Q 266 214 200 214 L 110 214 Z" fill="#E5E7EB"/>
            </g>

            <!-- Colorful magenta paths (revealed by mask AND clipped to letter shape) -->
            <g mask="url(#traceMask)" clip-path="url(#letterBClip)">
              <!-- Vertical stem -->
              <path d="M 96 41 L 124 41 L 124 359 L 96 359 Z" fill="#F97316"/>
              <!-- Top bump with proper rounded curve -->
              <path d="M 110 41 L 200 41 Q 294 41 294 127.5 Q 294 214 200 214 L 110 214 L 110 186 L 200 186 Q 266 186 266 127.5 Q 266 69 200 69 L 110 69 Z" fill="#F97316"/>
              <!-- Bottom bump with proper rounded curve -->
              <path d="M 110 186 L 200 186 Q 294 186 294 272.5 Q 294 359 200 359 L 110 359 L 110 331 L 200 331 Q 266 331 266 272.5 Q 266 214 200 214 L 110 214 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter C using SVG paths (perfect control) -->
          <!-- Tracing: starts at (280,100), curves to top (200,55), left (80,200), bottom (200,345), ends at (280,300) -->
          <g *ngIf="currentLetter === 'C'" id="letterCPaths">
            <!-- Gray outline paths (background) - proper C shape -->
            <g id="grayLetterCPaths">
              <!-- C shape: outer arc (294px from center) then inner arc (266px from center) back -->
              <path d="M 294 100 Q 294 41 200 41 Q 66 41 66 200 Q 66 359 200 359 Q 294 359 294 300 L 266 300 Q 266 331 200 331 Q 94 331 94 200 Q 94 69 200 69 Q 266 69 266 100 Z" fill="#E5E7EB"/>
            </g>

            <!-- Colorful magenta paths (revealed by mask AND clipped to letter shape) -->
            <g mask="url(#traceMask)" clip-path="url(#letterCClip)">
              <!-- C shape: same path as gray -->
              <path d="M 294 100 Q 294 41 200 41 Q 66 41 66 200 Q 66 359 200 359 Q 294 359 294 300 L 266 300 Q 266 331 200 331 Q 94 331 94 200 Q 94 69 200 69 Q 266 69 266 100 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter D using SVG paths -->
          <!-- Tracing: Vertical y=55-345 at x=100, Bump from (100,55) curves right to x=300 and back -->
          <g *ngIf="currentLetter === 'D'" id="letterDPaths">
            <!-- Gray outline paths (background) -->
            <g id="grayLetterDPaths">
              <!-- Vertical stem: x=100 ±14 = 86-114 -->
              <path d="M 86 41 L 114 41 L 114 359 L 86 359 Z" fill="#E5E7EB"/>
              <!-- D bump: outer at x=314, inner at x=286, joined to stem -->
              <path d="M 86 41 L 200 41 Q 314 41 314 200 Q 314 359 200 359 L 86 359 L 86 331 L 200 331 Q 286 331 286 200 Q 286 69 200 69 L 86 69 Z" fill="#E5E7EB"/>
            </g>

            <!-- Colorful magenta paths (revealed by mask AND clipped to letter shape) -->
            <g mask="url(#traceMask)" clip-path="url(#letterDClip)">
              <!-- Vertical stem -->
              <path d="M 86 41 L 114 41 L 114 359 L 86 359 Z" fill="#F97316"/>
              <!-- D bump, joined to stem -->
              <path d="M 86 41 L 200 41 Q 314 41 314 200 Q 314 359 200 359 L 86 359 L 86 331 L 200 331 Q 286 331 286 200 Q 286 69 200 69 L 86 69 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter E -->
          <g *ngIf="currentLetter === 'E'" id="letterEPaths">
            <g id="grayLetterEPaths">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#E5E7EB"/>
              <path d="M 100 66 L 294 66 L 294 94 L 100 94 Z" fill="#E5E7EB"/>
              <path d="M 100 186 L 274 186 L 274 214 L 100 214 Z" fill="#E5E7EB"/>
              <path d="M 100 306 L 294 306 L 294 334 L 100 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterEClip)">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#F97316"/>
              <path d="M 100 66 L 294 66 L 294 94 L 100 94 Z" fill="#F97316"/>
              <path d="M 100 186 L 274 186 L 274 214 L 100 214 Z" fill="#F97316"/>
              <path d="M 100 306 L 294 306 L 294 334 L 100 334 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter F -->
          <g *ngIf="currentLetter === 'F'" id="letterFPaths">
            <g id="grayLetterFPaths">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#E5E7EB"/>
              <path d="M 100 66 L 294 66 L 294 94 L 100 94 Z" fill="#E5E7EB"/>
              <path d="M 100 186 L 274 186 L 274 214 L 100 214 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterFClip)">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#F97316"/>
              <path d="M 100 66 L 294 66 L 294 94 L 100 94 Z" fill="#F97316"/>
              <path d="M 100 186 L 274 186 L 274 214 L 100 214 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter G -->
          <g *ngIf="currentLetter === 'G'" id="letterGPaths">
            <g id="grayLetterGPaths">
              <!-- G shape: C-arc with right arm from tongue to bottom curve, even 28px stroke -->
              <path d="M 294 100 Q 294 66 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 246 L 314 186 L 186 186 L 186 214 L 286 214 L 286 246 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Q 266 94 266 100 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterGClip)">
              <!-- G shape: C-arc with right arm from tongue to bottom curve, even 28px stroke -->
              <path d="M 294 100 Q 294 66 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 246 L 314 186 L 186 186 L 186 214 L 286 214 L 286 246 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Q 266 94 266 100 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter H -->
          <g *ngIf="currentLetter === 'H'" id="letterHPaths">
            <g id="grayLetterHPaths">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#E5E7EB"/>
              <path d="M 286 66 L 314 66 L 314 334 L 286 334 Z" fill="#E5E7EB"/>
              <path d="M 86 186 L 314 186 L 314 214 L 86 214 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterHClip)">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#F97316"/>
              <path d="M 286 66 L 314 66 L 314 334 L 286 334 Z" fill="#F97316"/>
              <path d="M 86 186 L 314 186 L 314 214 L 86 214 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter I -->
          <g *ngIf="currentLetter === 'I'" id="letterIPaths">
            <g id="grayLetterIPaths">
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z" fill="#E5E7EB"/>
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z" fill="#E5E7EB"/>
              <path d="M 106 306 L 294 306 L 294 334 L 106 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterIClip)">
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z" fill="#F97316"/>
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z" fill="#F97316"/>
              <path d="M 106 306 L 294 306 L 294 334 L 106 334 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter J - centered stem at x=200 -->
          <g *ngIf="currentLetter === 'J'" id="letterJPaths">
            <g id="grayLetterJPaths">
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z" fill="#E5E7EB"/>
              <path d="M 186 66 L 214 66 L 214 280 Q 214 334 160 334 Q 106 334 106 280 L 134 280 Q 134 306 160 306 Q 186 306 186 280 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterJClip)">
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z" fill="#F97316"/>
              <path d="M 186 66 L 214 66 L 214 280 Q 214 334 160 334 Q 106 334 106 280 L 134 280 Q 134 306 160 306 Q 186 306 186 280 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter K -->
          <g *ngIf="currentLetter === 'K'" id="letterKPaths">
            <g id="grayLetterKPaths">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#E5E7EB"/>
              <path d="M 293 68 L 307 92 L 107 212 L 93 188 Z" fill="#E5E7EB"/>
              <path d="M 107 188 L 93 212 L 293 332 L 307 308 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterKClip)">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#F97316"/>
              <path d="M 293 68 L 307 92 L 107 212 L 93 188 Z" fill="#F97316"/>
              <path d="M 107 188 L 93 212 L 293 332 L 307 308 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter L -->
          <g *ngIf="currentLetter === 'L'" id="letterLPaths">
            <g id="grayLetterLPaths">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#E5E7EB"/>
              <path d="M 86 306 L 294 306 L 294 334 L 86 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterLClip)">
              <path d="M 86 66 L 114 66 L 114 334 L 86 334 Z" fill="#F97316"/>
              <path d="M 86 306 L 294 306 L 294 334 L 86 334 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter M -->
          <g *ngIf="currentLetter === 'M'" id="letterMPaths">
            <g id="grayLetterMPaths">
              <path d="M 66 66 L 66 334 L 94 334 L 94 102 L 200 214 L 306 102 L 306 334 L 334 334 L 334 66 L 306 66 L 200 178 L 94 66 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterMClip)">
              <path d="M 66 66 L 66 334 L 94 334 L 94 102 L 200 214 L 306 102 L 306 334 L 334 334 L 334 66 L 306 66 L 200 178 L 94 66 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter N -->
          <g *ngIf="currentLetter === 'N'" id="letterNPaths">
            <g id="grayLetterNPaths">
              <path d="M 86 334 L 86 66 L 118 66 L 286 292 L 286 66 L 314 66 L 314 334 L 283 334 L 114 108 L 114 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterNClip)">
              <path d="M 86 334 L 86 66 L 118 66 L 286 292 L 286 66 L 314 66 L 314 334 L 283 334 L 114 108 L 114 334 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter O -->
          <g *ngIf="currentLetter === 'O'" id="letterOPaths">
            <g id="grayLetterOPaths">
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterOClip)">
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z" fill="#F97316" fill-rule="evenodd"/>
            </g>
          </g>

          <!-- Letter P -->
          <g *ngIf="currentLetter === 'P'" id="letterPPaths">
            <g id="grayLetterPPaths">
              <path d="M 86 334 L 86 66 L 210 66 Q 260 66 260 128 Q 260 190 210 190 L 114 190 L 114 334 Z M 114 94 L 210 94 Q 232 94 232 128 Q 232 162 210 162 L 114 162 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterPClip)">
              <path d="M 86 334 L 86 66 L 210 66 Q 260 66 260 128 Q 260 190 210 190 L 114 190 L 114 334 Z M 114 94 L 210 94 Q 232 94 232 128 Q 232 162 210 162 L 114 162 Z" fill="#F97316" fill-rule="evenodd"/>
            </g>
          </g>

          <!-- Letter Q -->
          <g *ngIf="currentLetter === 'Q'" id="letterQPaths">
            <g id="grayLetterQPaths">
              <!-- Gray oval ring -->
              <g clip-path="url(#letterQClipOval)">
                <rect x="0" y="0" width="400" height="400" fill="#E5E7EB"/>
              </g>
              <!-- Gray tail -->
              <g clip-path="url(#letterQClipTail)">
                <rect x="0" y="0" width="400" height="400" fill="#E5E7EB"/>
              </g>
            </g>
            <!-- Magenta oval ring -->
            <g mask="url(#traceMask)" clip-path="url(#letterQClipOval)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
            <!-- Magenta tail -->
            <g mask="url(#traceMask)" clip-path="url(#letterQClipTail)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter R -->
          <g *ngIf="currentLetter === 'R'" id="letterRPaths">
            <g id="grayLetterRPaths">
              <g clip-path="url(#letterRClipBody)">
                <rect x="0" y="0" width="400" height="400" fill="#E5E7EB"/>
              </g>
              <g clip-path="url(#letterRClipLeg)">
                <rect x="0" y="0" width="400" height="400" fill="#E5E7EB"/>
              </g>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterRClipBody)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterRClipLeg)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter S -->
          <g *ngIf="currentLetter === 'S'" id="letterSPaths">
            <g id="grayLetterSPaths">
              <!-- Top half of S -->
              <path d="M 270 110 Q 270 66 200 66 Q 110 66 110 138 Q 110 214 200 214 L 200 186 Q 138 186 138 138 Q 138 94 200 94 Q 242 94 242 110 Z" fill="#E5E7EB"/>
              <!-- Bottom half of S -->
              <path d="M 130 290 Q 130 334 200 334 Q 290 334 290 262 Q 290 186 200 186 L 200 214 Q 262 214 262 262 Q 262 306 200 306 Q 158 306 158 290 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterSClip)">
              <!-- Top half of S -->
              <path d="M 270 110 Q 270 66 200 66 Q 110 66 110 138 Q 110 214 200 214 L 200 186 Q 138 186 138 138 Q 138 94 200 94 Q 242 94 242 110 Z" fill="#F97316"/>
              <!-- Bottom half of S -->
              <path d="M 130 290 Q 130 334 200 334 Q 290 334 290 262 Q 290 186 200 186 L 200 214 Q 262 214 262 262 Q 262 306 200 306 Q 158 306 158 290 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter T -->
          <g *ngIf="currentLetter === 'T'" id="letterTPaths">
            <g id="grayLetterTPaths">
              <path d="M 86 66 L 314 66 L 314 94 L 86 94 Z" fill="#E5E7EB"/>
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterTClip)">
              <path d="M 86 66 L 314 66 L 314 94 L 86 94 Z" fill="#F97316"/>
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter U -->
          <g *ngIf="currentLetter === 'U'" id="letterUPaths">
            <g id="grayLetterUPaths">
              <path d="M 86 66 L 114 66 L 114 280 Q 114 326 200 326 Q 286 326 286 280 L 286 66 L 314 66 L 314 280 Q 314 354 200 354 Q 86 354 86 280 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterUClip)">
              <path d="M 86 66 L 114 66 L 114 280 Q 114 326 200 326 Q 286 326 286 280 L 286 66 L 314 66 L 314 280 Q 314 354 200 354 Q 86 354 86 280 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter V -->
          <!-- Letter V -->
          <g *ngIf="currentLetter === 'V'" id="letterVPaths">
            <g id="grayLetterVPaths">
              <path d="M 68 86 L 188 326 L 212 326 L 332 86 L 308 74 L 200 290 L 92 74 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterVClip)">
              <path d="M 68 86 L 188 326 L 212 326 L 332 86 L 308 74 L 200 290 L 92 74 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter W -->
          <g *ngIf="currentLetter === 'W'" id="letterWPaths">
            <g id="grayLetterWPaths">
              <path d="M 66 82 L 106 322 L 134 318 L 94 78 Z" fill="#E5E7EB"/>
              <path d="M 133 326 L 213 166 L 187 154 L 107 314 Z" fill="#E5E7EB"/>
              <path d="M 187 166 L 267 326 L 293 314 L 213 154 Z" fill="#E5E7EB"/>
              <path d="M 294 322 L 334 82 L 306 78 L 266 318 Z" fill="#E5E7EB"/>
              <path d="M 106 322 L 134 318 L 133 326 Z" fill="#E5E7EB"/>
              <path d="M 107 314 L 106 322 L 133 326 Z" fill="#E5E7EB"/>
              <path d="M 213 166 L 187 154 L 187 166 Z" fill="#E5E7EB"/>
              <path d="M 213 166 L 213 154 L 187 154 Z" fill="#E5E7EB"/>
              <path d="M 267 326 L 293 314 L 294 322 Z" fill="#E5E7EB"/>
              <path d="M 266 318 L 267 326 L 293 314 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterWClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter X -->
          <g *ngIf="currentLetter === 'X'" id="letterXPaths">
            <g id="grayLetterXPaths">
              <path d="M 89 89 L 289 329 L 311 311 L 111 71 Z" fill="#E5E7EB"/>
              <path d="M 289 71 L 89 311 L 111 329 L 311 89 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterXClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter Y -->
          <g *ngIf="currentLetter === 'Y'" id="letterYPaths">
            <g id="grayLetterYPaths">
              <path d="M 89 89 L 189 209 L 211 191 L 111 71 Z" fill="#E5E7EB"/>
              <path d="M 289 71 L 189 191 L 211 209 L 311 89 Z" fill="#E5E7EB"/>
              <path d="M 186 200 L 186 320 L 214 320 L 214 200 Z" fill="#E5E7EB"/>
              <path d="M 186 200 L 189 209 L 211 209 L 214 200 Z" fill="#E5E7EB"/>
              <path d="M 189 191 L 186 200 L 214 200 L 211 191 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterYClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Letter Z -->
          <g *ngIf="currentLetter === 'Z'" id="letterZPaths">
            <g id="grayLetterZPaths">
              <path d="M 100 66 L 300 66 L 300 94 L 100 94 Z" fill="#E5E7EB"/>
              <path d="M 289 71 L 89 311 L 111 329 L 311 89 Z" fill="#E5E7EB"/>
              <path d="M 100 306 L 300 306 L 300 334 L 100 334 Z" fill="#E5E7EB"/>
              <path d="M 300 66 L 311 89 L 300 94 Z" fill="#E5E7EB"/>
              <path d="M 289 71 L 300 66 L 300 94 Z" fill="#E5E7EB"/>
              <path d="M 89 311 L 100 306 L 100 334 Z" fill="#E5E7EB"/>
              <path d="M 100 306 L 111 329 L 100 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterZClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 0 -->
          <g *ngIf="currentLetter === '0'" id="letter0Paths">
            <g id="grayLetter0Paths">
              <path d="M 200 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 200 Q 314 66 200 66 M 200 94 Q 286 94 286 200 Q 286 306 200 306 Q 114 306 114 200 Q 114 94 200 94 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter0Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 1 -->
          <g *ngIf="currentLetter === '1'" id="letter1Paths">
            <g id="grayLetter1Paths">
              <!-- Vertical stem -->
              <path d="M 186 66 L 214 66 L 214 334 L 186 334 Z" fill="#E5E7EB"/>
              <!-- Flag diagonal with proper 28px perpendicular width -->
              <path d="M 152 94 L 192 68 L 208 92 L 168 118 Z" fill="#E5E7EB"/>
              <!-- Bottom bar -->
              <path d="M 126 306 L 274 306 L 274 334 L 126 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter1Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 2 -->
          <g *ngIf="currentLetter === '2'" id="letter2Paths">
            <g id="grayLetter2Paths">
              <!-- Top curve + diagonal -->
              <path d="M 86 120 Q 86 66 200 66 Q 314 66 314 120 Q 314 186 210 230 L 110 330 L 90 310 L 190 210 Q 286 166 286 120 Q 286 94 200 94 Q 114 94 114 120 Z" fill="#E5E7EB"/>
              <!-- Bottom bar -->
              <path d="M 86 306 L 314 306 L 314 334 L 86 334 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter2Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 3 -->
          <g *ngIf="currentLetter === '3'" id="letter3Paths">
            <g id="grayLetter3Paths">
              <path d="M 86 100 Q 126 66 200 66 Q 314 66 314 130 Q 314 186 214 200 Q 314 214 314 270 Q 314 334 200 334 Q 126 334 86 300 L 106 272 Q 140 306 200 306 Q 286 306 286 270 Q 286 214 200 214 L 200 186 Q 286 186 286 130 Q 286 94 200 94 Q 140 94 106 128 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter3Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 4 -->
          <g *ngIf="currentLetter === '4'" id="letter4Paths">
            <g id="grayLetter4Paths">
              <!-- Vertical stem -->
              <path d="M 246 66 L 274 66 L 274 334 L 246 334 Z" fill="#E5E7EB"/>
              <!-- Diagonal part -->
              <path d="M 270 90 L 110 250 L 90 230 L 250 70 Z" fill="#E5E7EB"/>
              <!-- Horizontal bar -->
              <path d="M 86 226 L 274 226 L 274 254 L 86 254 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter4Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 5 -->
          <g *ngIf="currentLetter === '5'" id="letter5Paths">
            <g id="grayLetter5Paths">
              <!-- Top horizontal bar -->
              <path d="M 106 66 L 294 66 L 294 94 L 106 94 Z" fill="#E5E7EB"/>
              <!-- Vertical stem -->
              <path d="M 106 66 L 134 66 L 134 184 L 106 184 Z" fill="#E5E7EB"/>
              <!-- Belly curve -->
              <path d="M 110 160 Q 202 136 262 182 Q 304 229 261 299 Q 202 344 110 310 L 130 290 Q 198 316 239 281 Q 276 231 239 198 Q 198 164 130 180 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter5Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 6 -->
          <g *ngIf="currentLetter === '6'" id="letter6Paths">
            <g id="grayLetter6Paths">
              <path d="M 280 96 Q 240 66 180 66 Q 86 66 86 200 Q 86 334 200 334 Q 314 334 314 260 Q 314 186 200 186 Q 114 186 114 230 L 114 186 Q 114 94 180 94 Q 220 94 252 124 Z M 200 214 Q 286 214 286 260 Q 286 306 200 306 Q 114 306 114 260 Q 114 214 200 214 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter6Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 7 -->
          <g *ngIf="currentLetter === '7'" id="letter7Paths">
            <g id="grayLetter7Paths">
              <path d="M 86 66 L 323 66 L 189 334 L 160 334 L 277 94 L 86 94 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter7Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 8 -->
          <g *ngIf="currentLetter === '8'" id="letter8Paths">
            <g id="grayLetter8Paths">
              <!-- Top loop -->
              <path d="M 200 200 Q 86 200 86 130 Q 86 66 200 66 Q 314 66 314 130 Q 314 200 200 200 M 200 172 Q 286 172 286 130 Q 286 94 200 94 Q 114 94 114 130 Q 114 172 200 172 Z" fill="#E5E7EB" fill-rule="evenodd"/>
              <!-- Bottom loop -->
              <path d="M 200 200 Q 86 200 86 270 Q 86 334 200 334 Q 314 334 314 270 Q 314 200 200 200 M 200 228 Q 286 228 286 270 Q 286 306 200 306 Q 114 306 114 270 Q 114 228 200 228 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter8Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Number 9 -->
          <g *ngIf="currentLetter === '9'" id="letter9Paths">
            <g id="grayLetter9Paths">
              <path d="M 120 304 Q 140 334 220 334 Q 314 334 314 200 Q 314 66 200 66 Q 86 66 86 130 Q 86 200 200 200 Q 286 200 286 170 L 286 200 Q 286 306 220 306 Q 160 306 140 276 Z M 200 172 Q 114 172 114 130 Q 114 94 200 94 Q 286 94 286 130 Q 286 172 200 172 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letter9Clip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter a -->
          <g *ngIf="currentLetter === 'a'" id="letteraPaths">
            <g id="grayLetteraPaths">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 L 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 160 Z" fill="#E5E7EB"/>
              <path d="M 266 106 L 294 106 L 294 294 L 266 294 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letteraClip)">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 L 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 160 Z" fill="#F97316"/>
              <path d="M 266 106 L 294 106 L 294 294 L 266 294 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter b -->
          <g *ngIf="currentLetter === 'b'" id="letterbPaths">
            <g id="grayLetterbPaths">
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z" fill="#E5E7EB"/>
              <path d="M 120 146 Q 120 106 200 106 Q 294 106 294 200 Q 294 294 200 294 Q 106 294 106 226 L 134 226 Q 134 266 200 266 Q 266 266 266 200 Q 266 134 200 134 Q 134 134 134 174 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterbClip)">
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z" fill="#F97316"/>
              <path d="M 120 146 Q 120 106 200 106 Q 294 106 294 200 Q 294 294 200 294 Q 106 294 106 226 L 134 226 Q 134 266 200 266 Q 266 266 266 200 Q 266 134 200 134 Q 134 134 134 174 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter c -->
          <g *ngIf="currentLetter === 'c'" id="lettercPaths">
            <g id="grayLettercPaths">
              <path d="M 294 146 Q 274 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 274 294 294 254 L 266 240 Q 254 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 246 134 266 160 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettercClip)">
              <path d="M 294 146 Q 274 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 274 294 294 254 L 266 240 Q 254 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 246 134 266 160 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter d -->
          <g *ngIf="currentLetter === 'd'" id="letterdPaths">
            <g id="grayLetterdPaths">
              <path d="M 266 46 L 294 46 L 294 294 L 266 294 Z" fill="#E5E7EB"/>
              <path d="M 294 226 Q 294 294 200 294 Q 106 294 106 200 Q 106 106 200 106 Q 294 106 294 146 L 266 160 Q 266 134 200 134 Q 134 134 134 200 Q 134 266 200 266 Q 266 266 266 240 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterdClip)">
              <path d="M 266 46 L 294 46 L 294 294 L 266 294 Z" fill="#F97316"/>
              <path d="M 294 226 Q 294 294 200 294 Q 106 294 106 200 Q 106 106 200 106 Q 294 106 294 146 L 266 160 Q 266 134 200 134 Q 134 134 134 200 Q 134 266 200 266 Q 266 266 266 240 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter e -->
          <g *ngIf="currentLetter === 'e'" id="letterePaths">
            <g id="grayLetterePaths">
              <!-- Top dome ring -->
              <path d="M 294 186 Q 294 106 200 106 Q 106 106 106 186 L 134 186 Q 134 134 200 134 Q 266 134 266 186 Z" fill="#E5E7EB"/>
              <!-- Bottom C-shape -->
              <path d="M 294 254 Q 274 294 200 294 Q 106 294 106 214 L 134 214 Q 134 266 200 266 Q 254 266 266 240 Z" fill="#E5E7EB"/>
              <!-- Horizontal bar -->
              <path d="M 106 186 L 294 186 L 294 214 L 106 214 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettereClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter f -->
          <g *ngIf="currentLetter === 'f'" id="letterfPaths">
            <g id="grayLetterfPaths">
              <path d="M 274 100 Q 274 46 200 46 Q 146 46 146 100 L 146 294 L 174 294 L 174 100 Q 174 74 200 74 Q 246 74 246 100 Z" fill="#E5E7EB"/>
              <path d="M 106 146 L 234 146 L 234 174 L 106 174 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterfClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter g -->
          <g *ngIf="currentLetter === 'g'" id="lettergPaths">
            <g id="grayLettergPaths">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 L 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 160 Z" fill="#E5E7EB"/>
              <path d="M 266 106 L 294 106 L 294 354 Q 294 394 200 394 Q 126 394 106 354 L 134 340 Q 146 366 200 366 Q 266 366 266 340 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettergClip)">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 L 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 160 Z" fill="#F97316"/>
              <path d="M 266 106 L 294 106 L 294 354 Q 294 394 200 394 Q 126 394 106 354 L 134 340 Q 146 366 200 366 Q 266 366 266 340 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter h -->
          <g *ngIf="currentLetter === 'h'" id="letterhPaths">
            <g id="grayLetterhPaths">
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z" fill="#E5E7EB"/>
              <path d="M 120 166 Q 120 106 200 106 Q 294 106 294 166 L 294 294 L 266 294 L 266 166 Q 266 134 200 134 Q 134 134 134 194 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterhClip)">
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z" fill="#F97316"/>
              <path d="M 120 166 Q 120 106 200 106 Q 294 106 294 166 L 294 294 L 266 294 L 266 166 Q 266 134 200 134 Q 134 134 134 194 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter i -->
          <g *ngIf="currentLetter === 'i'" id="letteriPaths">
            <g id="grayLetteriPaths">
              <path d="M 186 106 L 214 106 L 214 294 L 186 294 Z" fill="#E5E7EB"/>
              <circle cx="200" cy="60" r="14" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letteriClip)">
              <path d="M 186 106 L 214 106 L 214 294 L 186 294 Z" fill="#F97316"/>
              <circle cx="200" cy="60" r="14" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter j -->
          <g *ngIf="currentLetter === 'j'" id="letterjPaths">
            <g id="grayLetterjPaths">
              <path d="M 206 106 L 234 106 L 234 354 Q 234 394 160 394 Q 106 394 106 354 L 134 340 Q 134 366 160 366 Q 206 366 206 340 Z" fill="#E5E7EB"/>
              <circle cx="220" cy="60" r="14" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterjClip)">
              <path d="M 206 106 L 234 106 L 234 354 Q 234 394 160 394 Q 106 394 106 354 L 134 340 Q 134 366 160 366 Q 206 366 206 340 Z" fill="#F97316"/>
              <circle cx="220" cy="60" r="14" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter k -->
          <g *ngIf="currentLetter === 'k'" id="letterkPaths">
            <g id="grayLetterkPaths">
              <!-- Vertical stem -->
              <path d="M 106 46 L 134 46 L 134 294 L 106 294 Z" fill="#E5E7EB"/>
              <!-- Upper diagonal arm -->
              <path d="M 253 108 L 267 132 L 134 208 L 134 176 Z" fill="#E5E7EB"/>
              <!-- Lower diagonal arm -->
              <path d="M 134 191 L 286 267 L 274 293 L 134 223 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterkClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter l -->
          <g *ngIf="currentLetter === 'l'" id="letterlPaths">
            <g id="grayLetterlPaths">
              <path d="M 186 46 L 214 46 L 214 294 L 186 294 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterlClip)">
              <path d="M 186 46 L 214 46 L 214 294 L 186 294 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter m -->
          <g *ngIf="currentLetter === 'm'" id="lettermPaths">
            <g id="grayLettermPaths">
              <!-- Left n-shape: left stem + first arch + middle stem -->
              <path d="M 66 294 L 66 160 Q 66 106 140 106 Q 214 106 214 160 L 214 294 L 186 294 L 186 160 Q 186 134 140 134 Q 94 134 94 160 L 94 294 Z" fill="#E5E7EB"/>
              <!-- Right n-shape: middle stem + second arch + right stem -->
              <path d="M 186 294 L 186 160 Q 186 106 260 106 Q 334 106 334 160 L 334 294 L 306 294 L 306 160 Q 306 134 260 134 Q 214 134 214 160 L 214 294 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettermClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter n -->
          <g *ngIf="currentLetter === 'n'" id="letternPaths">
            <g id="grayLetternPaths">
              <path d="M 106 294 L 134 294 L 134 146 L 106 146 Z" fill="#E5E7EB"/>
              <path d="M 120 166 Q 120 106 200 106 Q 294 106 294 166 L 294 294 L 266 294 L 266 166 Q 266 134 200 134 Q 134 134 134 194 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letternClip)">
              <path d="M 106 294 L 134 294 L 134 146 L 106 146 Z" fill="#F97316"/>
              <path d="M 120 166 Q 120 106 200 106 Q 294 106 294 166 L 294 294 L 266 294 L 266 166 Q 266 134 200 134 Q 134 134 134 194 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter o -->
          <g *ngIf="currentLetter === 'o'" id="letteroPaths">
            <g id="grayLetteroPaths">
              <path d="M 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 Q 294 106 200 106 M 200 134 Q 266 134 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Z" fill="#E5E7EB" fill-rule="evenodd"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letteroClip)">
              <path d="M 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 200 Q 294 106 200 106 M 200 134 Q 266 134 266 200 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Z" fill="#F97316" fill-rule="evenodd"/>
            </g>
          </g>

          <!-- Lowercase letter p -->
          <g *ngIf="currentLetter === 'p'" id="letterpPaths">
            <g id="grayLetterpPaths">
              <path d="M 106 106 L 134 106 L 134 374 L 106 374 Z" fill="#E5E7EB"/>
              <path d="M 120 146 Q 120 106 200 106 Q 294 106 294 200 Q 294 294 200 294 Q 106 294 106 226 L 134 226 Q 134 266 200 266 Q 266 266 266 200 Q 266 134 200 134 Q 134 134 134 174 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterpClip)">
              <path d="M 106 106 L 134 106 L 134 374 L 106 374 Z" fill="#F97316"/>
              <path d="M 120 146 Q 120 106 200 106 Q 294 106 294 200 Q 294 294 200 294 Q 106 294 106 226 L 134 226 Q 134 266 200 266 Q 266 266 266 200 Q 266 134 200 134 Q 134 134 134 174 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter q -->
          <g *ngIf="currentLetter === 'q'" id="letterqPaths">
            <g id="grayLetterqPaths">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 226 L 266 226 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 174 Z" fill="#E5E7EB"/>
              <path d="M 266 106 L 294 106 L 294 374 L 266 374 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterqClip)">
              <path d="M 294 146 Q 294 106 200 106 Q 106 106 106 200 Q 106 294 200 294 Q 294 294 294 226 L 266 226 Q 266 266 200 266 Q 134 266 134 200 Q 134 134 200 134 Q 266 134 266 174 Z" fill="#F97316"/>
              <path d="M 266 106 L 294 106 L 294 374 L 266 374 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter r -->
          <g *ngIf="currentLetter === 'r'" id="letterrPaths">
            <g id="grayLetterrPaths">
              <path d="M 126 106 L 126 294 L 154 294 L 154 106 Z" fill="#E5E7EB"/>
              <path d="M 126 160 Q 126 106 200 106 Q 254 106 254 150 A 14 14 0 0 1 226 150 Q 226 134 200 134 Q 154 134 154 160 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterrClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter s -->
          <g *ngIf="currentLetter === 's'" id="lettersPaths">
            <g id="grayLettersPaths">
              <!-- Top half of s -->
              <path d="M 274 150 Q 274 106 200 106 Q 126 106 126 160 Q 126 214 200 214 L 200 186 Q 154 186 154 160 Q 154 134 200 134 Q 246 134 246 150 Z" fill="#E5E7EB"/>
              <!-- Bottom half of s -->
              <path d="M 126 250 Q 126 294 200 294 Q 274 294 274 240 Q 274 186 200 186 L 200 214 Q 246 214 246 240 Q 246 266 200 266 Q 154 266 154 250 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettersClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter t -->
          <g *ngIf="currentLetter === 't'" id="lettertPaths">
            <g id="grayLettertPaths">
              <path d="M 186 46 L 186 260 Q 186 294 230 294 A 14 14 0 0 0 230 266 Q 214 266 214 260 L 214 46 Z" fill="#E5E7EB"/>
              <path d="M 116 106 L 274 106 L 274 134 L 116 134 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettertClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter u -->
          <g *ngIf="currentLetter === 'u'" id="letteruPaths">
            <g id="grayLetteruPaths">
              <path d="M 106 106 L 106 220 Q 106 294 200 294 Q 294 294 294 220 L 294 106 L 266 106 L 266 220 Q 266 266 200 266 Q 134 266 134 220 L 134 106 Z" fill="#E5E7EB"/>
              <path d="M 266 220 L 294 220 L 294 294 L 266 294 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letteruClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter v -->
          <g *ngIf="currentLetter === 'v'" id="lettervPaths">
            <g id="grayLettervPaths">
              <path d="M 88 127 L 188 287 L 212 287 L 312 127 L 288 113 L 200 273 L 112 113 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#lettervClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter w -->
          <g *ngIf="currentLetter === 'w'" id="letterwPaths">
            <g id="grayLetterwPaths">
              <path d="M 67 125 L 127 285 L 153 275 L 93 115 Z" fill="#E5E7EB"/>
              <path d="M 152 287 L 212 187 L 188 173 L 128 273 Z" fill="#E5E7EB"/>
              <path d="M 188 187 L 248 287 L 272 273 L 212 173 Z" fill="#E5E7EB"/>
              <path d="M 273 285 L 333 125 L 307 115 L 247 275 Z" fill="#E5E7EB"/>
              <path d="M 127 285 L 152 287 L 153 275 L 128 273 Z" fill="#E5E7EB"/>
              <path d="M 212 187 L 188 187 L 188 173 L 212 173 Z" fill="#E5E7EB"/>
              <path d="M 248 287 L 273 285 L 272 273 L 247 275 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterwClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter x -->
          <g *ngIf="currentLetter === 'x'" id="letterxPaths">
            <g id="grayLetterxPaths">
              <path d="M 110 130 L 270 290 L 290 270 L 130 110 Z" fill="#E5E7EB"/>
              <path d="M 270 110 L 110 270 L 130 290 L 290 130 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterxClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter y -->
          <g *ngIf="currentLetter === 'y'" id="letteryPaths">
            <g id="grayLetteryPaths">
              <!-- U-shape body -->
              <path d="M 126 106 L 126 220 Q 126 274 200 274 Q 274 274 274 220 L 274 106 L 246 106 L 246 220 Q 246 246 200 246 Q 154 246 154 220 L 154 106 Z" fill="#E5E7EB"/>
              <!-- Right stem descender below curve -->
              <path d="M 274 220 L 274 354 Q 274 394 200 394 Q 126 394 106 354 L 134 340 Q 146 366 200 366 Q 246 366 246 340 L 246 220 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letteryClip)">
              <rect x="0" y="0" width="400" height="400" fill="#F97316"/>
            </g>
          </g>

          <!-- Lowercase letter z -->
          <g *ngIf="currentLetter === 'z'" id="letterzPaths">
            <g id="grayLetterzPaths">
              <path d="M 106 106 L 294 106 L 294 134 L 154 266 L 294 266 L 294 294 L 106 294 L 106 266 L 246 134 L 106 134 Z" fill="#E5E7EB"/>
            </g>
            <g mask="url(#traceMask)" clip-path="url(#letterzClip)">
              <path d="M 106 106 L 294 106 L 294 134 L 154 266 L 294 266 L 294 294 L 106 294 L 106 266 L 246 134 L 106 134 Z" fill="#F97316"/>
            </g>
          </g>

          <!-- Fallback for other characters -->
          <g *ngIf="!'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'.includes(currentLetter)" id="letterText">
            <text
              id="grayLetter"
              x="200"
              y="280"
              font-size="300"
              font-family="Arial Black, Arial, sans-serif"
              font-weight="900"
              text-anchor="middle"
              fill="#E5E7EB"
              stroke="#D1D5DB"
              stroke-width="4">
              {{currentLetter}}
            </text>

            <g mask="url(#traceMask)">
              <text
                x="200"
                y="280"
                font-size="300"
                font-family="Arial Black, Arial, sans-serif"
                font-weight="900"
                text-anchor="middle"
                fill="#F97316">
                {{currentLetter}}
              </text>
            </g>
          </g>

          <!-- Guide path for current stroke (hidden by default, shown on hint) -->
          <path
            *ngIf="!isFreeWriting"
            id="guidePath"
            stroke="#9CA3AF"
            stroke-width="3"
            fill="none"
            stroke-linecap="round"
            opacity="0"/>

          <!-- Start/End point indicators -->
          <g *ngIf="!isFreeWriting" id="arrowsGroup"></g>

          <!-- Letter decoration (hidden) -->
          <text x="310" y="100" font-size="60" id="letterDecor" opacity="0"></text>

          <!-- Sliding cursor that follows tracing -->
          <g *ngIf="showCursor" [attr.transform]="'translate(' + cursorX + ',' + cursorY + ')'" style="transition: transform 0.05s ease-out;">
            <!-- Glow -->
            <circle cx="0" cy="0" r="22" fill="#2196F3" opacity="0.15">
              <animate attributeName="r" values="22;28;22" dur="1.2s" repeatCount="indefinite"/>
              <animate attributeName="opacity" values="0.15;0.05;0.15" dur="1.2s" repeatCount="indefinite"/>
            </circle>
            <!-- Main cursor dot -->
            <circle cx="0" cy="0" r="14" fill="#2196F3" filter="drop-shadow(0 2px 6px rgba(33,150,243,0.4))"/>
          </g>

          </g><!-- End clipping group -->
        </svg>

        <!-- Drawing canvas for tracing mode (visible strokes) -->
        <canvas
          *ngIf="!isFreeWriting"
          #drawingCanvas
          class="absolute top-0 left-0 w-full h-full"
          style="touch-action: none; pointer-events: auto; background: transparent;">
        </canvas>
      </div>

      <!-- Pen Options (Writing Mode Only) -->
      <div *ngIf="isFreeWriting" class="mt-3 bg-gray-50 rounded-xl p-3 md:p-4 border border-gray-200">
        <div class="flex flex-wrap items-center justify-center gap-3 md:gap-5">
          <!-- Color Selection -->
          <div class="flex items-center gap-2 md:gap-3 bg-white rounded-full px-3 py-2 shadow-sm">
            <div class="flex gap-1.5">
              <button
                *ngFor="let c of availableColors; let i = index"
                (click)="selectColor(c.color)"
                class="w-7 h-7 md:w-9 md:h-9 rounded-full border-2 transition-all hover:scale-110"
                [style.backgroundColor]="c.color"
                [class.border-gray-800]="penColor === c.color"
                [class.border-gray-200]="penColor !== c.color"
                [class.ring-2]="penColor === c.color"
                [class.ring-gray-400]="penColor === c.color"
                [class.scale-110]="penColor === c.color">
              </button>
            </div>
          </div>

          <!-- Width Selection -->
          <div class="flex items-center gap-2 md:gap-3 bg-white rounded-full px-3 py-2 shadow-sm">
            <div class="flex gap-1.5">
              <button
                *ngFor="let w of availableWidths; let i = index"
                (click)="selectWidth(w)"
                class="w-8 h-8 md:w-10 md:h-10 rounded-full bg-white border-2 flex items-center justify-center transition-all hover:scale-110"
                [class.border-gray-800]="penWidth === w"
                [class.border-gray-200]="penWidth !== w"
                [class.bg-gray-100]="penWidth === w">
                <div
                  class="rounded-full transition-all"
                  [style.backgroundColor]="penColor"
                  [style.width.px]="w / 2"
                  [style.height.px]="w / 2">
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons (inside canvas card) -->
      <div class="action-buttons">
        <button (click)="clearDrawing()" class="action-btn action-btn-secondary">
          Clear
        </button>
        <button *ngIf="!isFreeWriting" (click)="showHint()" class="action-btn action-btn-primary">
          Hint
        </button>
      </div>
    </div>

    <!-- ── Info Panel (right side) ── -->
    <div class="info-card">

      <!-- Emoji -->
      <div class="info-emoji">
        <span class="info-emoji-text">
          @switch (currentLetter.toUpperCase()) {
            @case ('A') { 🍎 } @case ('B') { 🐻 } @case ('C') { 🐱 }
            @case ('D') { 🐶 } @case ('E') { 🥚 } @case ('F') { 🐟 }
            @case ('G') { 🐐 } @case ('H') { 🎩 } @case ('I') { 🏠 }
            @case ('J') { 🍓 } @case ('K') { 🪁 } @case ('L') { 🦁 }
            @case ('M') { 🌙 } @case ('N') { 🪺 } @case ('O') { 🦉 }
            @case ('P') { 🐷 } @case ('Q') { 👑 } @case ('R') { 🌹 }
            @case ('S') { ☀️ } @case ('T') { 🌲 } @case ('U') { ⬆️ }
            @case ('V') { 🚐 } @case ('W') { 🐺 } @case ('X') { 🩻 }
            @case ('Y') { 🦬 } @case ('Z') { 🦓 }
            @default { {{ currentLetter }} }
          }
        </span>
      </div>

      <!-- Word + Phonetic -->
      <div class="info-word-block">
        <div class="info-word">
          <span class="info-word-first">{{ getWordFirst() }}</span><span class="info-word-rest">{{ getWordRest() }}</span>
        </div>
        <div class="info-phonetic">{{ getPhonetic() }}</div>
      </div>

      <div class="info-divider"></div>

      <!-- Progress -->
      <div class="info-section">
        <span class="info-section-label">✏️ PROGRESS</span>
        <div class="info-progress-bar">
          <div class="info-progress-fill" [style.width.%]="traceProgress"></div>
        </div>
        <span class="info-progress-text">{{ traceProgress }}% complete</span>
      </div>

      <div class="info-divider"></div>

      <!-- Letter position -->
      <div class="info-section">
        <span class="info-section-label">📍 POSITION</span>
        <span class="info-meta-text">{{ getLetterPosition() }}</span>
      </div>

      <div class="info-divider"></div>

      <!-- Fun Fact -->
      <div class="info-section">
        <span class="info-section-label">💡 FUN FACT</span>
        <p class="info-fact-text">{{ getFunFact() }}</p>
      </div>

      <div class="info-divider"></div>

      <!-- Strokes -->
      @if (!isFreeWriting && getStrokeCount() > 0) {
        <div class="info-section">
          <span class="info-section-label">✍️ STROKES</span>
          <div class="info-strokes-row">
            @for (s of [].constructor(getStrokeCount()); track $index) {
              <div class="info-stroke-dot" [class.info-stroke-done]="$index < getCompletedStrokeCount()"></div>
            }
          </div>
          <span class="info-strokes-text">{{ getCompletedStrokeCount() }} / {{ getStrokeCount() }} strokes</span>
        </div>
        <div class="info-divider"></div>
      }

      <!-- Encouragement -->
      <div class="info-encourage">
        <p class="info-encourage-text">{{ getEncouragement() }}</p>
      </div>


    </div>

    </div><!-- /.main-layout -->

  </div>
</div>
